LifeLog - 基于微服务架构的生活记录平台   
                    
技术栈：Gin、gRPC、GORM、MySQL、Redis、JWT、Kafka、Viper、MinIO、Zap、ELK、Wire等

项目概述：

    LifeLog是一个使用Go语言，Gin框架，gRPC框架开发的web微服务应用，旨在为用户提供一个安全、高效的生活记录平台。
    实现了生活记录的收集、存储、展示及互动功能，支持文字、图片和视频等多种形式的数据。
    目前，平台已成功收集并处理了超过4万条生活记录数据，为实验室课题组的LifeLog研究提供了坚实的数据基础。

项目成果： 为实验室课题组的LifeLog研究提供了高质量的数据支持，推动了LifeLog研究的进展。

项目功能：

1.登录服务

    将JWT的校验逻辑封装为Gin的Middleware，实现了统一的登录校验。
    使用Lua脚本限制用户发送短信的频率和总量，防止非法用户恶意消耗短信资源。
    使用Lua脚本限制用户验证短信的次数，防止非法用户暴力破解。
    使用布隆过滤器实现手机号黑名单，阻止非法用户发送短信。
    使用Lua脚本实现滑动窗口限流，防止服务器被大量请求击垮。
    使用Redis的Zset数据类型实现历史密码库，不允许用户使用历史密码当作新密码。
    使用bcrypt不可逆哈希算法对密码进行加密，避免数据库存储明文。
    使用长短token机制，短token用于登录校验，长token用于给短token续约。
    增加辅助校验，想办法将非法用户和正常用户区分开，比如浏览器指纹、IP、硬件信息等。
    增加二次校验，在用户准备进行一些高危操作时，额外增加短信验证码校验。
    由此构建了一个安全性较为出色的登陆服务。
    
2.退出服务

    使用Redis实现了token的实时失效管理，有效防止token滥用和非法访问。
    
3.短信服务

     使用Lua脚本限制用户发送短信的频率和总量，防止非法用户恶意消耗短信资源。
     使用布隆过滤器实现手机号黑名单，阻止非法用户发送短信。添加权限控制，只允许有权限的接口调用短信服务。
     使用装饰器模式动态扩展新功能，如指数退避重试，failover策略(随机轮询和连续超时次数)。
     监控发送短信失败的情况，及时通知开发者处理问题。
     结合降级策略，构建了一个更加稳健的短信服务。

4.生活记录服务

    主要功能包括生活记录的分页查询和增删改。
    设计了线上库与制作库的双库架构，支持在不影响用户观看的前提下修改生活记录。
    设计了一个缓存一致性解决方案，先更新数据库再删除缓存，延迟双删；有效降低了数据不一致的发生概率。
    设计了一个特定的缓存淘汰策略，优先淘汰访问次数少的lifeLog；确保缓存命中率不会明显下降。
    使用布隆过滤器，避免了缓存穿透。
    设计了一个缓存方案，缓存前几页生活记录，业务缓存预加载；使用K6压测接口100并发，时长3分钟，
    分页查询接口的QPS从239req/s提升到1594req/s（提升567%），P99延迟从1.22s降低到193ms（降低84%）。
    详情接口的QPS从597req/s提升到856req/s（提升43%），  P99延迟从1.74s降低到835ms（降低52%）,显著提升了接口性能，降低了网络延迟；
    设计了一个redis缓存监控方案。分页查询接口的缓存命中率为86.5%，lifeLog详情的缓存命中率为81.6%。
    设计了一个redis崩溃应对方案，引入本地缓存和降级策略；不仅可以在redis崩溃时提供兜底，还进一步提高了查询接口的性能。
    使用K6压测接口100并发，时长3分钟，分页查询接口的QPS从1594req/s提升到1923req/s	（提升21%），P99延迟从193ms降低到180ms（降低7%）。
    详情接口的QPS从856req/s提升到912req/s（提升6%），P99延迟从835降低到655ms（降低21%）。
    
5.收藏夹服务

    主要功能包括收藏夹的分页查询和增删改，收藏夹详情展示。
    设计了一个缓存方案，使用K6压测100并发，时长3分钟，系统的QPS从659req/s提升到1766req/s（提升168%）	
    P99延迟从929ms降低到206ms（降低78%），显著提升了接口性能，降低了网络延迟。

6.评论服务

    使用邻接表维护评论的树形结构，确保评论的高效存储与检索。
    通过Sarama实现Kafka异步批量消费评论，提升系统的并发处理能力。
    评论表引入UUID字段，并添加唯一索引，确保消费者幂等，避免插入相同的评论。
    
7.文件服务

    使用MinIO作为文件存储服务，设计了小文件（<100MB）直接上传保持低延迟，
    大文件(>=100M)异步分片上传的混合方案，默认分片大小100M/片。
    在9MB/s的网速下测试，520M的视频，不分片上传花费60s，分片上传花费12s（降低了80%）。
    
8.互动服务

    实现了点赞、收藏、阅读、关注等功能，提升了用户的参与感与平台的社交属性。

    
9.Feed流服务

    实现了评论、点赞、收藏、关注、阅读的feed流服务，确保用户能够查看到最新消息。
    
10.日志采集

    使用ELK实现了日志的统一采集，存储与可视化检索。
    使用Zap框架采集日志，使用Filebeat读取.log文件，使用Logstash过滤插件处理日志，最终将日志	
    发送到ElasticSearch中，并使用Kibana可视化检索日志。
    
11.压测

    会使用k6对接口进行压测，并将压测结果在Grafana平台可视化展示。
    
12.Docker

    会简单使用docker-compose来部署开发环境。
